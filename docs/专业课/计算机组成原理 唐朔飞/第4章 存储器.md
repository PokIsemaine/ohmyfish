# 第4章 存储器

## 4.1 概述

### 4.1.1 存储器分类

* 按存储介质分类：半导体存储器、磁表面存储器、磁芯存储器、光盘存储器
* 按存取方式分类：随机存储器`RAM`,只读存储器`ROM`、串行访问存储器
* 按在计算机中的作用分类：主存储器、辅助存储器、缓冲存储器


![image-20220101151612130](https://s2.loli.net/2022/01/01/BClM1tJVpwgYjLO.png)

### 4.1.2 存储器的层次结构

* 存器的性能指标：速度、容量、每位价格
* 存储系统层次结构主要体现在 缓存-主存 和 主存-辅存这两个存储层次上
* 缓存-主存层次主要解决CPU和主存速度不匹配的问题
* 主存-辅存层次主要解决存储系统的容量问题
* 主存-辅存不断发展逐渐形成了虚拟存储系统



## 4.2 主存储器

### 4.2.1 概述

* 主存中存储单元地址的空间位置由单元地址号来表示，地址总线指出存储单元的地址号，根据该地址可读写一个存储字

* 通常计算机系统既可以按字寻址，也可以按字节寻址

* 主存的主要技术指标是存储容量和速度

* $存储容量=存储单元数*存储字长（二进制代码总位数）=存储单元数*存储字长/8(字节总数)$

* 存储速度由存取时间和存储和周期表示

	* 存取时间又称存储器访问时间，指启动一次存储器操作到完成该操作所需全部时间
	* 存取时间分为读出时间和写入时间
	* 存取周期指存储器进行连续两次独立的存储器操作所需最小间隔时间
	* 存取周期通常大于存储时间

* 存储带宽与存储周期密切相关，它表示单位时间存储器存取的信息量，是衡量数据传输率的重要指标。下面是提高存储带宽的方法

	* 缩短存取周期
	* 增加存储字长
	* 增加存储器体

	

	

### 4.2.2 半导体存储芯片简介

半导体存储芯片的基本结构

* 半导体存储芯片采用超大规模集成电路制造工艺，在一个芯片内集成具有记忆功能的存储矩阵、译码驱动电路和读/写电路等
* 译码驱动电路可以将总线送来的地址信号翻译成对应存储单元的选择信号
* 读/写电路包括读出放大器和写入电路
* 存储芯片通过地址总线、数据总线和控制总线与外部连接
* 地址线单向输入，位数和芯片容量有关
* 数据线双向，位数和芯片可读出可写入数据位数有关
* 控制线主要有读/写控制线与片选线两种

半导体存储芯片的译码驱动方式：

* 线选法：一个线性的数组
* 重合法：二维矩阵，行列地址分别译码，节省物理空间提高集成度



### 4.2.3 随机存取存储器

随机存取存储器按照存储信息原理不同可分为：静态 RAM 和动态 RAM

**静态RAM**

* 保存01的原理：利用触发器存储信息，断电也也能存
* 行选择：T5、T6，列选择：T7、T8

* 读操作步骤：行选、列选、读有效、A两个读放
* 写操作步骤：行选、列选、写有效、$D_{IN}$两个写放（要两个的相反电平，不如没法存进去啊）

**动态 RAM(DRAM)**

* 基本电路有三管式和单管式两种，通过电容存储电荷的原理存储信息
* 即使电源不掉电，信息也会自动小时，因此必须刷新或再生
* 相比静态RAM相比，集成度高、功耗更低
* 读出线的高低电平可区分其是读1还是读0,只是它与原存信息反相
* 写入与输入信息相同



**动态RAM刷新**

* 集中刷新：一个刷新周期内，对全部存储器单元集中一段时间逐行进行刷新，刷新时必须停止读/写（死时间）
* 分散刷新：对每行存储单元的刷新分散到每个存取周期内完成，不存在死时间，但存取周期变长了，整个系统速度降低了
* 异步刷新：前两种方式结合，类似分块的思想，整体分散刷新，块内集中刷新。刷新只停止一个存取周期，克服集中刷新死时间和分散刷新存取周期过长



动态RAM与静态RAM比较

|          | DRAM | SRAM   |
| -------- | ---- | ------ |
| 存储原理 | 电容 | 触发器 |
| 集成度   | 高   | 多     |
| 芯片引脚 | 少   | 大     |
| 价格     | 低   | 高     |
| 速度     | 慢   | 快     |
| 刷新     | 有   | 无     |

一般动态RAM做主存，静态RAM做缓存



### 4.2.4 只读存储器

半导体ROM基本器件：MOS 型和 TTL 型

掩模 ROM

* 行列选择线交叉处有 MOS 管为 1
* 行列选择线交叉处无 MOS 管为 0
* 用户无法改变原始状态

PROM

* 一次性编程
* 熔丝断为 0 ，未断为 1

EPROM

* 多次性编程
* 采用N型沟道浮动栅 MOS 电路
* 紫外线擦除，时间长

EEPROM（EPROM改进，擦写时间短）

* 多次性编程
* 电可擦写、局部擦写、全部擦写

Flash Memory 闪速存储器

* 性价比好、可靠性高
* 集成度高
* 擦写速度快，存储器访问周期短
* 功耗低，接口简单
* 具备 RAM 功能



### 4.2.5 存储器与 CPU 的连接

**存储器容量扩展**

* 位扩展：增加存储字长
* 字扩展：增加存储器字的数量
* 字、位扩展：既增加存储字长，又增加存储器字的数量

**存储器与CPU的连接**

* 地址线的连接：低位作为地址，高位作为片选信号。
* 数据线的连接
* 读/写命令线的连接
* 片选线的连接
* 合理选择存储芯片
* 还要考虑时序、负载



### 4.2.6 存储器的教研

汉明码的组成

* 汉明码具有一位纠错能力
* 检测能力和纠错能力都与编码的最小距离有关，编码最小距离是指一种编码系统中任意两组合法代码之间的最少二进制位数的差异
* 纠错理论：$L-1=D+C且D>=C$,最小距离越大，检测位数和纠错位数越大
* 为了能准确对错误定位以及指出没错，新增的检测位数k应该满足$2^k>=n+k+1$
* 检测为放在编号为1,2,4,8……的位置上

汉明码纠错：对传送后的汉明码新检测位$P_i$,根据$P_i$状态之处位置



### 4.2.7 提高访存速度的措施

除了找高速元件和采用层次结构，还可以通过调整主存结构提高访存速度或者采用高性能存储芯片

* 单体多字系统：一个地址取出多条指令，但是会导致存储器结构复杂，如果指令不是连续存放效果不明显
* 多体并行



## 4.3 高速缓冲存储器
