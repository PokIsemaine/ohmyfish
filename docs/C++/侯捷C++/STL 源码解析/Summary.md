# Summary 



## 容器与迭代器

### 迭代器类型

| 容器                                                       | 迭代器                                                       |
| ---------------------------------------------------------- | ------------------------------------------------------------ |
| vector、deque                                              | 随机访问迭代器                                               |
| stack、queue、priority_queue                               | 无                                                           |
| list、（multi)set、(multi)map                              | 双向迭代器<br />`set`的迭代器为`const_iterator`杜绝写入操作，是一种`constant iterator`<br />`map`的迭代器既不是`constant iterator`也不是`mutable iterators` |
| forward_list、unordered\_(multi)map、unordered\_(multi)set | 前向迭代器                                                   |



### 迭代器失效

| 容器              | 失效情况                                                     |
| ----------------- | ------------------------------------------------------------ |
| vector、deque     | 插入元素<br />1. 尾后插入，size < capacity：首迭代器不失效，尾迭代器失效<br />2. 尾后插入/中间插入，size == capacity：所有迭代器均失效（需要重新分配空间）<br />3. 中间插入，size < capacity：首迭代器不失效，插入元素之后的所有迭代器失效<br />删除元素<br />尾后删除：只有尾迭代器失效<br />中间删除：删除位置之后所有迭代器失效 |
| list              | 插入、接合不会造成迭代器失效<br />删除节点：仅当前迭代器失效，erase 返回下一个有效迭代器 |
| map、set          | 删除节点：仅当前迭代器失效，mp.erase(iter++)获取下一个迭代器 |
| unordered_map/set | 迭代器意义不大，rehash之后全部失效                           |



## 容器底层实现

| 容器           | 底层实现                                                     |
| -------------- | ------------------------------------------------------------ |
| list           | 双向循环链表                                                 |
| vector         | 单向开口的连续线性空间，因此普通指针都可以作为vector的迭代器 |
| deque          | 双向开口的连续线性空间，动态地以分段连续空间组合而成。因此deque没有容量概念，也没提供空间保留（reserve） |
| stack/queue    | deque 或 list                                                |
| priority_queue | vector 形式的 `binary heap`                                  |
|                |                                                              |



## 容器扩容

| 容器   | 扩容方式                                        |
| ------ | ----------------------------------------------- |
| array  | 大小固定，不能扩容                              |
| vector | 重新分配空间（2倍/1.5倍），移动数据，释放原空间 |
| deque  |                                                 |
|        |                                                 |
|        |                                                 |
|        |                                                 |

